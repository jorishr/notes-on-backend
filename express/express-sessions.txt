################
EXPRESS SESSIONS
##############################
I.	ABOUT SESSIONS
II.	SESSION OPTIONS
	A.	[SECRET]
	B.	[COOKIE]
	C.	[RESAVE]
	D.	[SAVEUNINITIALISED]
##############################

####################
I.	ABOUT SESSIONS
####################

Sessions are used to identify users across http requests (which are independent from each other).

		session = require('express-session')
		app.use(session({
			secret: 'randomString',
			resave: false,
			saveUnitialized: false
		}));

NOTE: the SECRET should be a unique random string that belongs to your project. Do not store it in the app.js but use an ENV VAR.

After this is done, all the requests to the app routes are now using sessions. Every user of you API or website will be assigned a unique session, and this allows you to store the user state.

SESSION OBJECT

IMPORTANT: The session is an object attached to each http request, so you can access it using req.session:
	
	console.log(req.session)

The session data is stored in memory by default. This is meant for development purposes only. 

For production you can store it in a database like MySQL or Mongo. A third option is to use a memory cache like Redis or Memcached.

All solutions store the session id in a cookie, and keep the full session data server-side. The client will receive the session id in a cookie, and will send it along with every HTTP request.

SESSION STORE 

In production, you’ll need to set up a scalable session-store; see the list in the express-session docs.

For MongoDB: connect-mogo package

See connect-mongo doc.

#####################
II.	SESSION OPTIONS
#####################

A.	[SECRET]

The session secret is a key used for signing and/or encrypting cookies set by the application to maintain session state.

Cookies are the most common way for web applications to persist state (like the currently logged in user) across distinct HTTP requests. 

To achieve this, web browsers will hang on to pieces of information that a web server wants to remember, dutifully sending it back with each subsequent request to remind the server that, for example, we are still logged in.

A malicious client could alter the Cookie header before transmission, with unpredictable results. Thus servers SHOULD encrypt and sign the contents of cookies.

A session secret that is not sufficiently cryptographically random can be guessed with fairly little time, effort and resources.

	app.use(expressSession({
   	 	secret: process.env.EXPRESS_SECRET,
    	}));


B.	[COOKIE]

The example below has the default values.
 
The secure: true is a recommended option. However, it requires an https-enabled website, i.e., HTTPS. If secure is set, and you access your site over HTTP, the cookie will not be set.

If both expires and maxAge are set in the options, then the last one defined in the object is what is used. The expires option should not be set directly; instead only use the maxAge option.

maxAge is the number (in ms) to use when calculating the Expires Set-Cookie attribute. This is done by taking the current server time and adding maxAge milliseconds to the value to calculate an Expires datetime. By default, no maximum age is set.

app.use(expressSession({
	secret: process.env.EXPRESS_SECRET,
	cookie: { 
		path: '/', 
		httpOnly: true, 
		secure: false, 
		maxAge: null 
	}
}));

C.	[RESAVE]

Forces the session to be saved back to the session store, even if the session was never modified during the request. Set it to false but check the session-store docs.

The best way is to check if it implements the touch method. If it does, you can safely set resave: false. 
If it does not implement the touch method and your store sets an expiration date on stored sessions, then you likely need resave: true.

D.	[SAVEUNINITIALISED]

Forces a session that is "uninitialized" to be saved to the store. 

A session is uninitialized when it is new but not modified. 

Choosing false is useful for implementing login sessions, reducing server storage usage, or complying with laws that require permission before setting a cookie. 